# 1. 介绍

这个作业给你一个将神经网络学习应用于人脸识别问题的机会。它分为两部分。对于剩下的部分，你必须独自完成，你将实验一个神经网络程序来训练一个太阳镜识别器，一个人脸识别器和一个姿势识别器。对于第二部分，这是可选的，只能获得额外学分，你可以选择与一到两个其他学生一起研究你自己选择的一些问题。您将使用的面部图像是早期机器学习课程中学生的面部图像。

您不需要为这项任务编写大量代码，也不应该被这个文档的大小吓倒，但是训练您的网络需要时间。建议你先完整地阅读作业，然后尽早开始。

## 1.1. 人脸图像

图像数据可以在 **/afs/cs/project/theo-8/faceimages/faces ** 中找到。这个目录包含20个子目录，每个人一个，由 **userid** 命名。每个目录都包含同一个人的几张不同的面部图像。

您将对以下命名约定的图像感兴趣:

​	<userid> <pose> <expression> <eyes> <scale>.pgm

- <userid> 是图像中人物的用户id，该字段有20个值:an2i、at33、boland、bpm、ch4f、cheyer、choon、danieln、glickman、karyadi、kawamura、kk49、megak、mitchell、night、phoebe、saavik、steffi、sz24和tammo。
- <pose> 是这个人的头部位置，这个字段有4个值:直、左、右、上。
- <expression> 是人的面部表情，这个领域有4个值:中性，快乐，悲伤，愤怒。
- <eyes> 是人的眼睛状态，这个字段有两个值:开放，太阳镜。
- <scale> 是图像的比例，该字段有3个值:1、2和4。1表示全分辨率图像(128列* 120行);2表示半分辨率图像(64 * 60);4为1 / 4分辨率图像(32 * 30)。对于这个任务，你将使用四分之一分辨率的图像进行实验，以保持训练时间到一个可管理的水平。

如果您仔细查看了映像目录，您可能会注意到有些映像具有 **.bad** 后缀而不是 **.pgm** 后缀。事实证明，在拍摄的640张照片中，有16张照片由于相机设置问题而出现故障;这些是 **.bad** 的图像。有些人比其他人有更多的故障，但每个“被脸”的人应该至少有28张好的脸(从32个可能的变化中，打折比例)。

## 1.2. 查看人脸图像

要查看这些图像，可以使用程序 xv。它在Andrew机器上的路径是/usr/local/bin/xv，或者/usr/misc/。CS机器上的X11-others/bin/xv或/usr/local/bin/xv。xv可以处理各种图像格式，包括存储人脸图像的PGM格式。虽然我们不会在本文中详细介绍xv，但我们将快速描述使用xv所需了解的基础知识。

​	要启动xv，只需在命令行上指定一个或多个图像，如下所示:

​	```xv /afs/cs/project/theo-8/faceimages/faces/glickman/glickman straight happy open 4.pgm```

这将打开一个显示人脸的X窗口。单击图像窗口中的右键将切换带有各种按钮的控制面板。Dbl Size按钮每次点击图像时都会将显示的图像大小加倍。这对于查看四分之一分辨率的图像很有用，正如您想象的那样。

您也可以通过按住左键同时移动图像窗口中的指针来获取像素值。将显示一个文本栏，显示指针所在的图像坐标和亮度值。

要退出xv，只需单击quit按钮或在其中一个xv窗口中输入q。

## 1.3. 神经网络和图像访问代码

我们提供了一个三层全连接前馈神经网络的 C 代码，该网络使用反向传播算法来调整权重。为了尽可能简化操作，我们还为您提供了用于访问人脸图像的图像包，以及用于训练和测试的顶级程序，作为骨架供您修改。为了帮助您了解网络的实际学习效果，我们还提供了一个将隐藏单元权重可视化为图像的实用程序。

代码位于 /afs/cs/project/theo-8/faceimages/code。将该区域中的所有文件复制到你自己的目录中，然后键入 make。注意：使用 cp * 而不是 cp *.*，以确保获得 Makefile。编译完成后，你将得到一个可执行程序：facetrain。facetrain 可以用于训练和或识别，还能将网络保存到文件中。

该代码已在CS端的Alphas、DecStations、Sun Pentium-2和IBM PowerPC以及Andrew端的DecStations和Sun Pentium-5上成功编译和测试。如果您希望在其他平台上使用这些代码，请随意，但请注意，这些代码仅在这些平台上进行过测试。 

有关例程的详细信息、源文件的说明以及相关信息，请参阅本手册的 ?? 部分。

# 2. 作业

## 2.1. 第一部分



跳过这一部分

# 3. 文档

此作业的代码分为几个模块：

- pgmimage.c、pgmimage.h：镜像包。支持PGM图像文件的读/写和像素访问/分配。提供 IMAGE 数据结构和 IMAGELIST 数据结构（指向图像的指针数组；在处理许多图像时很有用）。您无需修改本模块中的任何代码即可完成作业。
- backprop.c、backprop.h：神经网络包。支持三层全连接前馈网络，使用反向传播算法进行权值调整。提供创建、训练和使用网络的高级例程。您无需修改本模块中的任何代码即可完成作业。
- imagenet.c：用于将图像加载到网络输入单元并设置训练目标向量的接口例程。在实现面部识别器和姿势识别器时，您将需要修改例程加载目标，以便为您选择的输出编码设置适当的目标向量。
- facetrain.c：顶级程序，它使用上面的所有模块来实现 \TA" 识别器。您需要修改此代码来更改网络大小和学习参数，这两者都是微不足道的更改。性能评估例程imagelist() 上的性能和评估性能() 也在这个模块中；您将需要针对您的面部和姿势识别器修改这些。
- hidtopgm.c：隐藏的单位重量可视化实用程序。尽管探索众多可能的替代可视化方案中的一些可能会很有趣，但无需在此进行任何修改。

